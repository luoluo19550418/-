#+TITLE: PaaS程序設計
#+AUTHOR: lujun9972
#+TAGS: .
#+DATE: [2019-05-10 五 21:35]
#+LANGUAGE:  zh-CN
#+STARTUP:  inlineimages
#+OPTIONS:  H:6 num:nil toc:t \n:nil ::t |:t ^:nil -:nil f:t *:t <:nil

* 遗留应用迁移到PaaS的注意事项:

** 文件上传存储

传统应用一般是将上传的文件存储在文件系统上，因为及时服务器崩溃了，用户只要重启机器，文件依然存在。
而基于PaaS供应商的文件系统可能不稳定，机器重启时系统不会重新装载，从而导致上传的文件丢失。

在PaaS上还提供一种存储文件的方法那就是"对象存储"，用户上传文件时通过编程接口存储文件内容，编程接口会返回一个URL。用户可以存储该URL链接而不是文件本身。
采用对象存储的好处之一是上传的所有文件，被自动复制到不同服务器上，这样数据不容易丢失也更稳定。

** 会话管理

如果应用运行在单服务器上，应用会话通常缺省保存在硬盘上的某个临时文件中，但在PaaS上通常会启动多个应用实例，这意味着应用会在多个不同服务器上运行，而对应用的使用者来说，这意味着他们的登录可能会被无缘无故地注销掉.

在PaaS上通常有三种典型的方法存放会话数据。

+ 用对象存储技术存储会话文件
+ NoSQL会话存储
+ SQL会话存储
** 异步化

PaaS服务商可能会杀掉长时间运行的进程，或者按照进程的运行时长付费，因此异步化非常重要。

** SQL

在很多PaaS平台上，会限制SQL存储过程的使用。
* 在PaaS上开发新应用程序
+ 在PaaS上开发应用程序时，一般将大型程序根据各个数据源以及每个专业区域作为一个小的，独立运行的服务。
+ 在后端创建独立的服务后，通过前端进行整合
+ 对代码进行优化，确保请求数量的最少化，否者将要付出高昂的费用。
* 评估PaaS服务
** 一般问题
+ 应用可以访问多少数据存储
+ 应用需要持久磁盘存储吗
+ 应用需要将文件写到磁盘上吗
+ 写到磁盘上的文件保存有时效性吗
+ 一个应用实例可以使用多少RAM
+ 如果应用达到资源上限，会发声什么情况
** 数据库
在尝试自己设置托管服务的时候，最让人头疼的事情之一就是数据库。
管理数据库并进行备份所花费的时间可能比写应用程序的代码还要多。

+ 供应商如何收费,按每个月的查询数量?按数据存储容量？按并发连接数?
+ 应用每个月有多少数据库查询？
+ 数据库数据存储能力有多少？
+ 允许多少并发查询？
+ 提供冗余存储吗？
+ 提供失效恢复机制吗？
** 缓存
+ 是否提供了冗余机制？
+ 是否有失效恢复机制？
+ 能缓存多少数据？
** 监控
作为开发者，必须了解程序的负载、数据库的运行情况。也就是必须弄清楚有多少人并发地获取数据，以及服务是否能够成功地满足这些要求。

+ 供应商可以提供什么类型的监控信息？
+ 你可以拥有哪些方面的控制？
+ 供应商是否具有自动扩展功能？
+ 在达到资源上限时，供应商是否会通知你？
** 性能
+ 供应商是否提供性能统计或者具备这些功能的插件？
+ 供应商是否提供负载均衡测试服务？

* PaaS服务的优劣势
考虑PaaS的限制与益处的问题时，实际上就是一个控制的问题。开发者愿意并且能够放弃的控制越多，那么可以利用的PaaS功能就会越多。

| PaaS益处               | PaaS限制                   |
|------------------------+----------------------------|
| 专有主机托管，扩展容易 | 巨型应用可能导致问题       |
| 共享托管的简易性       | 数据限制可能带来的潜在矛盾 |
| 更快地应用开发和部署   | 通常没有文件系统支持       |
| 内置N层架构支持        | 无法处理超高性能的应用场景 |
| 后台时完全可管理的     | 定制运行时可能会产生问题   |
| 更好的前期花费         | 更多的月度开销             |
